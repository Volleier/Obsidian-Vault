# 介绍

**边缘检测（Edge Detection）的目标是识别图像中强度突然变化（不连续） 的区域**。边缘往往包含丰富的语义与形状信息，且相比直接处理像素，边缘表达更紧凑。边缘检测通常用于将图像从“像素级强度场”转化为“结构化的轮廓/边界信息”，为后续任务提供更稳定的输入。

## 边缘产生原因

1. **表面法线不连续**：物体几何形状的突变。
2. **深度不连续**：物体间的遮挡或背景。
3. **表面颜色不连续**：物体表面反射率（Albedo）的变化。
4. **光照不连续**：由阴影等引起。

## 核心理论与物理概念

### 图像梯度

把图像看作二维函数 $I(x,y)$，边缘对应 $I$ 的快速变化。梯度向量指向强度增加最快的方向，且与边缘方向垂直。

- **梯度向量**：$\nabla I = \left[\frac{\partial I}{\partial x},\ \frac{\partial I}{\partial y}\right]$
- **边缘强度（梯度幅值）**：$\|\nabla I\| = \sqrt{G_x^2 + G_y^2}$
- **梯度方向**：$\theta = \operatorname{atan2}(G_y, G_x)$

### 梯度算子

**梯度算子（Gradient operator）是用于计算多元函数在各变量方向变化率的向量算子，其数学符号为 $\nabla$**。在离散图像处理中，该算子通过差分卷积核近似实现。

## 数学实现：卷积与滤波器

### 利用卷积计算导数

在离散图像上，偏导数通常用有限差分近似。例如 x 方向前向差分：

$$
\frac{\partial f}{\partial x}(x,y) \approx f(x+1,y) - f(x,y)
$$

常用单位长度卷积核实现：

- **检测垂直边缘 (x 方向分量)**：$\begin{bmatrix}-1&1\end{bmatrix}$
- **检测水平边缘 (y 方向分量)**：$\begin{bmatrix}-1\\1\end{bmatrix}$

### 噪声影响与“先平滑再求导”

噪声会显著放大导数估计的不稳定性。利用卷积的结合性：$\frac{\partial}{\partial x}(f * g) = f * \frac{\partial g}{\partial x}$，我们可以将“平滑 + 求导”合并为一次卷积。

**高斯导数滤波器（Gaussian Derivative Filters）**：

- **尺度参数 $\sigma$**：控制平滑程度。$\sigma$ 越大，抗噪能性越强，但边缘定位越模糊。
- **计算形式**：$G_x = I * \frac{\partial G}{\partial x}$，$G_y = I * \frac{\partial G}{\partial y}$。
- **可分离性**：$G(x,y)=G(x)G(y)$，因此 $\frac{\partial G}{\partial x}$ 可通过对 x 方向用“高斯导数”、y 方向用“高斯平滑”来高效实现。

### 平滑 vs 导数滤波器对比

| 特性       | 平滑滤波器（如高斯）   | 导数滤波器（如高斯导数）  |
| :--------- | :--------------------- | :------------------------ |
| **作用**   | 低通滤波，去除高频噪声 | 高通滤波，提取边缘        |
| **值范围** | 全正，和为 1           | 可正可负，和为 0          |
| **响应**   | 对平坦区域影响小       | 对平坦区域无响应/响应很弱 |

# 算法

## 基础梯度算子

### Sobel 算子（一阶梯度）

Sobel 是经典的一阶梯度核，在提取边缘的同时能抑制一定噪声。

- **x 方向核 ($K_x$)**：$\begin{bmatrix}-1&0&1\\-2&0&2\\-1&0&1\end{bmatrix}$
- **y 方向核 ($K_y$)**：$\begin{bmatrix}-1&-2&-1\\0&0&0\\1&2&1\end{bmatrix}$

### 拉普拉斯算子（二阶导数）

拉普拉斯算子近似二阶导数，对“变化的变化”敏感，常用于边缘增强。

$$
\nabla^2 I = \frac{\partial^2 I}{\partial x^2} + \frac{\partial^2 I}{\partial y^2}
$$

- **离散核**：$\begin{bmatrix}0&-1&0\\-1&4&-1\\0&-1&0\end{bmatrix}$

## Canny 边缘检测器

Canny 是工程应用中最广泛的边缘检测算法，旨在获得单像素宽且连通性好的边缘。

### 实现流程

1. **高斯平滑**：抑制噪声，$I_s = I * G(\sigma)$。
2. **梯度计算**：计算梯度幅值 $M$ 与方向 $\theta$。
3. **非极大值抑制（NMS）**：沿梯度方向（法向方向）只保留局部最大值，将“粗边缘”细化。
   - **方向量化**：将 $\theta$ 量化到 $0^\circ, 45^\circ, 90^\circ, 135^\circ$ 进行相邻像素比较。
   - **线性插值**：利用双线性插值获取梯度方向上的亚像素幅值进行比较，定位更精确。
4. **滞后阈值（Hysteresis Thresholding）**：使用高低两档阈值。
   - **强边缘** ($M \ge T_h$)：必保留。
   - **弱边缘** ($T_l \le M < T_h$)：仅当与强边缘相连通时才保留。
   - **抑制** ($M < T_l$)：舍弃。
