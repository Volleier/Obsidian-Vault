# 介绍
**边缘检测（Edge Detection）** 的目标是识别图像中亮度或强度发生突然变化（不连续）的区域。边缘通常承载了图像中最重要的语义与形状信息。

边缘产生的原因：
1. 表面法线不连续：物体的几何拐角、转折。
2. 深度不连续：物体之间的遮挡关系。
3. 表面颜色（反射率）不连续：物体的纹理或图案变化。
4. 光照不连续：阴影边界。

边缘检测的目标：
- 紧凑性：将“像素级强度场”转化为“结构化的轮廓/边界”。
- 准确性：边缘位置应尽可能精确。
- 稳定性：对噪声有良好的抑制能力。


# 数学基础

## 图像梯度和梯度算子
**图像梯度是二维离散函数的求导运算，通过对图像像素值的差分计算来描述图像局部区域的变化率，广泛应用于图像边缘检测等计算机视觉任务。** 而梯度算子是计算图像梯度的算子，是计算图像区域变化值的数学工具。

**梯度算子（Gradient operator）是用于计算多元函数在各变量方向变化率的向量算子，其数学符号为∇（nabla）**。

作为描述物理场变化的基本工具，梯度算子作用于标量场时形成梯度。在不同正交坐标系中，其运算形式存在差异，如柱坐标系中表现为径向、角向和轴向分量的组合，球坐标系中则涉及球面坐标系的特定展开。

梯度向量：
$$
\nabla I = \left[\frac{\partial I}{\partial x},\ \frac{\partial I}{\partial y}\right]^T
$$

- 梯度方向：指向强度增加最快的方向，与边缘方向垂直。
- 梯度幅值 $M$：边缘的强度。
  $$M = \sqrt{G_x^2 + G_y^2} \approx |G_x| + |G_y|$$
### 常见梯度算子
| 算子                       |        窗口 | 是否含平滑  | 旋转一致性 |    抗噪性 |     定位精度 |       计算复杂度 |
| ------------------------ | --------: | ------ | ----: | -----: | -------: | ----------: |
| Roberts                  |       2×2 | 否      |     差 |     很差 |       很高 |          极低 |
| Prewitt                  |       3×3 | 弱，等权   |    一般 |     一般 |       中等 |           低 |
| Sobel                    |       3×3 | 有中心权重  |    一般 |     较好 |       较好 |      低（可分离） |
| Scharr                   |       3×3 | 有改进权重  |     好 |     较好 |       更好 | 低（类似 Sobel） |
| 中心差分（Central）            | 1×3 / 3×1 | 否，对称   |     好 |     很差 |        高 |          极低 |
| 高斯导数（Gaussian ∂）         |   可变（随 σ） | 有可调 σ  | 随核设计好 | 很好（可调） |   随 σ 可控 |  中—高（核越大越慢） |
| Compass（Kirsch/Robinson） | 多方向 3×3 组 | 通常无    |     差 |      差 | 中等（方向量化） |    中等（多次卷积） |
| Frei–Chen                |    3×3 基组 | 部分有基展开 |    较好 |     中等 |       中等 |          中等 |




## 导数性质

- **一阶导数**：图像强度的突变处表现为一阶导数的**极值点**。
- **二阶导数**：图像强度的突变处表现为二阶导数的**过零点**。



## 3. 噪声抑制与高斯导数

微分操作本质上是“高通”滤波，会对高频噪声产生显著的放大作用。因此，边缘检测通常遵循 **“先平滑，再求导”** 的工作流。

### 3.1 结合性原理

根据卷积的结合性：
$$\frac{\partial}{\partial x}(I * G) = I * \frac{\partial G}{\partial x}$$
这意味着我们可以将高斯平滑核与导数算子合并为 **高斯导数滤波器 (Gaussian Derivative Filters)**，仅通过一次卷积即可完成去噪与提取导数的功能。

### 3.2 高斯导数核的特性

- **尺度参数 $\sigma$**：
  - $\sigma$ 较大：抗躁强，但边缘定位模糊。
  - $\sigma$ 较小：定位精确，但对噪声敏感。
- **可分离性 (Separability)**：
  - 计算 $G_x$：在 $x$ 方向应用高斯导数核，在 $y$ 方向应用标准一维高斯核。这可以极大提升计算效率。



## 4. 经典梯度算子

在离散图像上，我们使用有限差分或特定的模板（Kernel）来近似导数。

### 4.1 Sobel 算子

Sobel 是最常用的算子，它结合了水平/垂直方向的平滑与差分。

- **Horizontal ($K_x$)**: 检测垂直边缘
  $$ \begin{bmatrix} -1 & 0 & 1 \\ -2 & 0 & 2 \\ -1 & 0 & 1 \end{bmatrix} $$
- **Vertical ($K_y$)**: 检测水平边缘
  $$ \begin{bmatrix} -1 & -2 & -1 \\ 0 & 0 & 0 \\ 1 & 2 & 1 \end{bmatrix} $$

### 4.2 拉普拉斯算子 (Laplacian)

拉普拉斯是各向同性的二阶微分算子，对“强度的变化率”敏感。
$$ \nabla^2 I = \frac{\partial^2 I}{\partial x^2} + \frac{\partial^2 I}{\partial y^2} $$
**常用 8-邻域核**：
$$ \begin{bmatrix} -1 & -1 & -1 \\ -1 & 8 & -1 \\ -1 & -1 & -1 \end{bmatrix} $$
_应用_：常用于边缘增强或作为高级特征检测（如 LoG）的基础。

---

## 5. Canny 边缘检测算法

Canny 是边缘检测的事实标准，它旨在实现**低错误率**、**良好的定位**以及**单像素响应**。

### 5.1 实现步骤

1. **高斯平滑**：抑制高频噪声。
2. **计算梯度幅值与方向**：通常使用 Sobel 算子获取 $M$ 和 $\theta$。
3. **非极大值抑制 (NMS)**：
   - **目标**：将粗大的梯度响应“瘦身”为单像素宽的边缘。
   - **逻辑**：沿着梯度方向 $\theta$ 检查邻域，若当前像素幅值不是局部最大值，则将其置为 0。
   - **方式**：支持“方向量化”（4 个主方向）或“线性插值”（更高精度）。
4. **滞后阈值 (Hysteresis Thresholding)**：
   - 设定高阈值 $T_H$ 和低阈值 $T_L$。
   - **强边缘**：$M > T_H$，保留。
   - **弱边缘**：$T_L < M < T_H$，仅当其与强边缘连通时才保留。
   - **噪声**：$M < T_L$，剔除。

### 6.2 常用算子总结

- **Sobel**：计算简单，对噪声有一定抑制作用，但边缘较粗。
- **Laplacian**：对噪声极度敏感，通常不直接检测边缘，而用于定位过零点。
- **Canny**：效果最好，边缘精细，抗噪性强，但计算复杂度相对较高。
